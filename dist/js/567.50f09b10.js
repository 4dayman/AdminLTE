"use strict";(self["webpackChunkadminlte"]=self["webpackChunkadminlte"]||[]).push([[567],{2422:function(t,s,e){e.d(s,{Z:function(){return w}});var i=e(6252);const l=t=>((0,i.dD)("data-v-6fce9f6a"),t=t(),(0,i.Cn)(),t),a={class:"lds-spinner"},r=l((()=>(0,i._)("div",null,null,-1))),n=l((()=>(0,i._)("div",null,null,-1))),c=l((()=>(0,i._)("div",null,null,-1))),o=l((()=>(0,i._)("div",null,null,-1))),u=l((()=>(0,i._)("div",null,null,-1))),m=l((()=>(0,i._)("div",null,null,-1))),d=l((()=>(0,i._)("div",null,null,-1))),f=l((()=>(0,i._)("div",null,null,-1))),h=l((()=>(0,i._)("div",null,null,-1))),p=l((()=>(0,i._)("div",null,null,-1))),g=l((()=>(0,i._)("div",null,null,-1))),$=l((()=>(0,i._)("div",null,null,-1))),_=[r,n,c,o,u,m,d,f,h,p,g,$];function v(t,s,e,l,r,n){return(0,i.wg)(),(0,i.iD)("div",a,_)}var L={name:"Loader"},b=e(3744);const y=(0,b.Z)(L,[["render",v],["__scopeId","data-v-6fce9f6a"]]);var w=y},2567:function(t,s,e){e.r(s),e.d(s,{default:function(){return W}});var i=e(6252),l=e(9963);const a=t=>((0,i.dD)("data-v-41029db0"),t=t(),(0,i.Cn)(),t),r={class:"row"},n={class:"col"},c={class:"card"},o=a((()=>(0,i._)("div",{class:"card-header"},[(0,i._)("h3",{class:"card-title"},"Страница фильма")],-1))),u={class:"card-body"},m={class:"film_name"},d={class:"input-group mb-3"},f=a((()=>(0,i._)("p",null,"Название фильма:",-1))),h={class:"film_desc"},p={class:"input-group mb-3"},g=a((()=>(0,i._)("p",null,"Описание:",-1))),$={class:"film_banner mb-3"},_=a((()=>(0,i._)("p",null,"Главная картинка:",-1))),v={class:"film_image_body ml-2"},L={key:0,class:"film_image"},b=["src"],y={class:"banners_add"},w=a((()=>(0,i._)("i",{class:"fas fa-plus"},null,-1))),k=a((()=>(0,i._)("i",{class:"fas fa-minus"},null,-1))),D={class:"film_galery film_banner mb-3"},C=a((()=>(0,i._)("p",null,"Галерея картинок:",-1))),S={class:"film_image_body ml-2"},U=["onClick"],F=["src"],q={class:"banners_add"},x=a((()=>(0,i._)("i",{class:"fas fa-plus"},null,-1))),H={class:"card-footer"},R={class:"custom-control custom-switch custom-switch-lg"},V={key:0,class:"custom-control-label",for:"mainBannersSwitch"},Z={key:1,class:"custom-control-label",for:"mainBannersSwitch"};function B(t,s,e,a,B,I){const J=(0,i.up)("content-header"),j=(0,i.up)("content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(J,{title:"Страница фильма",icon:"fas fa-info-circle"}),(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i._)("div",n,[(0,i._)("div",c,[o,(0,i._)("div",u,[(0,i._)("div",m,[(0,i._)("div",d,[f,(0,i.wy)((0,i._)("input",{class:"form-control ml-1",type:"text",placeholder:"Название фильма","onUpdate:modelValue":s[0]||(s[0]=t=>this.$store.state.films.currentList[this.$route.params.id].data[0].title=t)},null,512),[[l.nr,this.$store.state.films.currentList[this.$route.params.id].data[0].title]])])]),(0,i._)("div",h,[(0,i._)("div",p,[g,(0,i.wy)((0,i._)("textarea",{class:"form-control ml-1",type:"text",placeholder:"Text","onUpdate:modelValue":s[1]||(s[1]=t=>this.$store.state.films.currentList[this.$route.params.id].data[0].desc=t)},null,512),[[l.nr,this.$store.state.films.currentList[this.$route.params.id].data[0].desc]])])]),(0,i._)("div",$,[_,(0,i._)("div",v,[this.$store.state.films.currentList[this.$route.params.id].images[0].cover.url?((0,i.wg)(),(0,i.iD)("div",L,[(0,i._)("img",{src:this.$store.state.films.currentList[this.$route.params.id].images[0].cover.url},null,8,b)])):(0,i.kq)("",!0),(0,i._)("label",y,[(0,i._)("button",{class:"btn btn-primary square",onClick:s[2]||(s[2]=t=>this.$refs.coverSelect.click())},[w,(0,i.Uk)(" Добавить фото")]),(0,i._)("input",{class:"banner_input",ref:"coverSelect",type:"file",accept:"image/*",onChange:s[3]||(s[3]=t=>I.coverSelect(t))},null,544)]),(0,i._)("button",{class:"btn btn-primary square",onClick:s[4]||(s[4]=t=>this.$store.state.films.currentList[this.$route.params.id].images[0].cover.url="")},[k,(0,i.Uk)(" Удалить фото")])])]),(0,i._)("div",D,[C,(0,i._)("div",S,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.$store.state.films.currentList[this.$route.params.id].images[0].gallery,(s=>((0,i.wg)(),(0,i.iD)("div",{class:"film_image",key:s.id},[(0,i._)("span",{class:"badge bg-danger poa",onClick:e=>t.delGalleryImg(s.id)},"X",8,U),(0,i._)("img",{src:s.url},null,8,F)])))),128)),(0,i._)("label",q,[(0,i._)("button",{class:"btn btn-primary square",onClick:s[5]||(s[5]=t=>this.$refs.filmsSelect.click())},[x,(0,i.Uk)(" Добавить фото")]),(0,i._)("input",{class:"banner_input",ref:"filmsSelect",type:"file",multiple:"multiple",accept:"image/*",onChange:s[6]||(s[6]=t=>I.filmsSelect(t))},null,544)])])])]),(0,i._)("div",H,[(0,i._)("div",R,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"custom-control-input",id:"mainBannersSwitch","onUpdate:modelValue":s[7]||(s[7]=t=>this.$store.state.films.currentList[this.$route.params.id].data[0].toggle=t)},null,512),[[l.e8,this.$store.state.films.currentList[this.$route.params.id].data[0].toggle]]),this.$store.state.films.currentList[this.$route.params.id].data[0].toggle?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("label",V," now ")),this.$store.state.films.currentList[this.$route.params.id].data[0].toggle?((0,i.wg)(),(0,i.iD)("label",Z," upcom ")):(0,i.kq)("",!0)]),(0,i._)("button",{class:"btn btn-primary float-right",onClick:s[8]||(s[8]=t=>I.uploadFilm(this.$route.params.id))},"Сохранить"),(0,i._)("button",{class:"btn btn-primary float-right",onClick:s[9]||(s[9]=t=>I.resetFilm(this.$route.params.id))},"Вернуть базовую версию")])])])])])),_:1})],64)}e(7658);var I=e(2392),J=e(6650),j=e(3247),G=e(2422),K={components:{Loader:G.Z},created(){this.id=this.$route.params.id},data(){return{file:null,files:null}},methods:{coverSelect(){this.file=this.$refs.coverSelect.files[0],this.$store.state.films.currentList[this.$route.params.id].images[0].cover.image=this.file,this.$store.state.films.currentList[this.$route.params.id].images[0].cover.url=URL.createObjectURL(this.file),this.$store.state.films.currentList[this.$route.params.id].data[0].cover.name=this.$store.state.films.currentList[this.$route.params.id].images[0].cover.name=this.$store.state.films.currentList[this.$route.params.id].name},filmsSelect(){this.files=this.$refs.filmsSelect.files;for(let t=0;t<this.files.length;t++)this.$store.state.films.currentList[this.$route.params.id].data[0].gallery.push({id:t,name:"Gallery-"+Date.now(),url:null}),this.$store.state.films.currentList[this.$route.params.id].images[0].gallery.push({id:t,name:this.$store.state.films.currentList[this.$route.params.id].data[0].gallery[t].name,uploaded:!1,image:this.files[t],url:URL.createObjectURL(this.files[t])})},async uploadFilm(t){for(let e=0;e<this.$store.state.films.currentList[t].images.length;e++){if(null!==this.$store.state.films.currentList[t].images[0].cover.image)try{const s=(0,J.iH)(I.t,"films/cover/"+this.$store.state.films.currentList[t].name);await(0,J.KV)(s,this.$store.state.films.currentList[t].images[0].cover.image).then((async()=>{await(0,J.Jt)(s).then((s=>{this.$store.state.films.currentList[t].data[0].cover.url=s,this.uploadFilmData(t)}))}))}catch(s){console.log(s)}else this.uploadFilmData(t);if(0!==this.$store.state.films.currentList[t].images[0].deleted.length)for(let s=0;s<this.$store.state.films.currentList[t].images[0].deleted.length;s++){const e=(0,J.iH)(I.t,"films/gallery/"+this.$store.state.films.currentList[t].images[0].deleted[s]);await(0,J.oq)(e).then((()=>{this.$store.state.films.currentList[t].images[0].deleted.splice(s,1)})).catch((t=>{console.log(t)}))}this.uploadFilmData(t)}this.$router.push({name:"films"})},async uploadFilmData(t){const s={data:this.$store.state.films.currentList[t].data};await(0,j.pl)((0,j.JU)(I.db,"films",this.$store.state.films.currentList[t].name),s).then((()=>{this.uploaded=!0}))},async resetFilm(t){if(this.$store.state.films.currentList[t].uploaded){for(let i=0;i<this.$store.state.films.currentList[t].images.length;i++)this.$store.state.films.currentList[t].images[i].cover.name=null,this.$store.state.films.currentList[t].images[i].cover.image=null,this.$store.state.films.currentList[t].images[i].cover.url=null;const s=(0,j.JU)(I.db,"films",this.$store.state.films.currentList[t].name),e=await(0,j.QT)(s);if(e.exists()){this.$store.state.films.currentList[t].data=e.data().data;for(let s=0;s<this.$store.state.films.currentList[t].data.length;s++)this.$store.state.films.currentList[t].images[s].cover.name=this.$store.state.films.currentList[t].data[s].cover.name,this.$store.state.films.currentList[t].images[s].cover.url=this.$store.state.films.currentList[t].data[s].cover.url}}}}},O=e(3744);const T=(0,O.Z)(K,[["render",B],["__scopeId","data-v-41029db0"]]);var W=T}}]);
//# sourceMappingURL=567.50f09b10.js.map